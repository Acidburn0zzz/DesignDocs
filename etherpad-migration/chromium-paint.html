<!doctype html>
<html lang="en">
<head>
<title>chromium-paint</title>
<meta name="generator" content="Etherpad">
<meta name="author" content="Etherpad">
<meta name="changedby" content="Etherpad">
<meta charset="utf-8">
<style>
* {
  font-family: arial, sans-serif;
  font-size: 13px;
  line-height: 17px;
}
ul.indent {
  list-style-type: none;
}
ol {
  list-style-type: none;
  padding-left: 0;
}
body > ol {
  counter-reset: first second third fourth fifth sixth seventh eigth ninth tenth eleventh twelth thirteenth fourteenth fifteenth sixteenth;
}
ol > li:before {
  content: counter(first) ". ";
  counter-increment: first;
}
ol > ol > li:before {
  content: counter(first) "." counter(second) ". ";
  counter-increment: second;
}
ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) ". ";
  counter-increment: third;
}
ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) ". ";
  counter-increment: fourth;
}
ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) ". ";
  counter-increment: fifth;
}
ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) ". ";
  counter-increment: sixth;
}
ol > ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) ". ";
  counter-increment: seventh;
}
ol > ol > ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) ". ";
  counter-increment: eigth;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) ". ";
  counter-increment: ninth;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) ". ";
  counter-increment: tenth;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) ". ";
  counter-increment: eleventh;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) ". ";
  counter-increment: twelth;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) "." counter(thirteenth) ". ";
  counter-increment: thirteenth;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) "." counter(thirteenth) "." counter(fourteenth) ". ";
  counter-increment: fourteenth;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) "." counter(thirteenth) "." counter(fourteenth) "." counter(fifteenth) ". ";
  counter-increment: fifteenth;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {
  content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) "." counter(thirteenth) "." counter(fourteenth) "." counter(fifteenth) "." counter(sixthteenth) ". ";
  counter-increment: sixthteenth;
}
ol {
  text-indent: 0px;
}
ol > ol {
  text-indent: 10px;
}
ol > ol > ol {
  text-indent: 20px;
}
ol > ol > ol > ol {
  text-indent: 30px;
}
ol > ol > ol > ol > ol {
  text-indent: 40px;
}
ol > ol > ol > ol > ol > ol {
  text-indent: 50px;
}
ol > ol > ol > ol > ol > ol > ol {
  text-indent: 60px;
}
ol > ol > ol > ol > ol > ol > ol > ol {
  text-indent: 70px;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol {
  text-indent: 80px;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol {
  text-indent: 90px;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol {
  text-indent: 100px;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol {
  text-indent: 110px;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol {
  text-indent: 120px;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol {
  text-indent: 130px;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol {
  text-indent: 140px;
}
ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol {
  text-indent: 150px;
}

</style>
</head>
<body>
blink Display item types - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;paint&#x2F;DisplayItem&#x2e;h&#x3f;q&#x3d;blink&#x3a;&#x3a;DisplayItem&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;61">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;paint&#x2F;DisplayItem.h?q=blink::DisplayItem&amp;sq=package:chromium&amp;l=61</a><br>Display Lists seem to be overused in both chromium and blink. There are blink display items and cc display items.<br><br>blink web items are just skia items? - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;blink&#x2F;web&#x5f;display&#x5f;item&#x5f;list&#x5f;impl&#x2e;h&#x3f;q&#x3d;appendDrawingItem&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;46">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;blink&#x2F;web_display_item_list_impl.h?q=appendDrawingItem&amp;sq=package:chromium&amp;l=46</a> - appendDisplayItem is an SkPicture? Seems odd.<br><br>The skia commands that we can actually record - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;skia&#x2F;include&#x2F;private&#x2F;SkRecords&#x2e;h&#x3f;q&#x3d;SK&#x5f;RECORD&#x5f;TYPES&amp;sq&#x3d;package&#x3a;chromium&amp;dr&#x3d;C&amp;l&#x3d;44">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;skia&#x2F;include&#x2F;private&#x2F;SkRecords.h?q=SK_RECORD_TYPES&amp;sq=package:chromium&amp;dr=C&amp;l=44</a><br><br>Plays commands through SkCanvas which does some analysis on the canvas as a whole it seems - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;skia&#x2F;ext&#x2F;analysis&#x5f;canvas&#x2e;h&#x3f;q&#x3d;AnalysisCanvas&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;21">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;skia&#x2F;ext&#x2F;analysis_canvas.h?q=AnalysisCanvas&amp;sq=package:chromium&amp;l=21</a><br>Current implementation still seems to not use display list and goes from frame tree -&gt; SkCanvas commands. - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;GraphicsContext&#x2e;cpp&#x3f;q&#x3d;GraphicsContext&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;238">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;GraphicsContext.cpp?q=GraphicsContext&amp;sq=package:chromium&amp;l=238</a> . This implies this is mostly still true - <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;chromium&#x2e;org&#x2F;developers&#x2F;design&#x2d;documents&#x2F;gpu&#x2d;accelerated&#x2d;compositing&#x2d;in&#x2d;chrome">https:&#x2F;&#x2F;www.chromium.org&#x2F;developers&#x2F;design-documents&#x2F;gpu-accelerated-compositing-in-chrome</a><br>Slimming paint display items are wrappers around skia draw calls that existed before slimming paint. eg. DrawingDisplayItem is just a wrapper around SkPicture<br><br>Slimming paint part 2 isn&#x27;t finished yet ,so current build (Sept 2016), still has graphics layers and blink isn&#x27;t shipping display items directly to cc.&nbsp;<br>Right now<br><ul class="bullet"><li>invalidate based on layout objects</li><li>compute partial display lists, but those get converted back to a single SkPicture for cc::Layer consumption to raster. - Converting WebContentDisplayList to CC::display lists - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;blink&#x2F;web&#x5f;content&#x5f;layer&#x5f;impl&#x2e;cc&#x3f;q&#x3d;web&#x5f;content&#x5f;layer&#x5f;&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;75">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;blink&#x2F;web_content_layer_impl.cc?q=web_content_layer_&amp;sq=package:chromium&amp;l=75</a></li></ul><br>Frame Tree in Chrome is LayoutObject (<a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;layout&#x2F;LayoutObject&#x2e;h&#x3f;q&#x3d;LayoutObject&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;209&#x29;">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;layout&#x2F;LayoutObject.h?q=LayoutObject&amp;sq=package:chromium&amp;l=209)</a><br>They have two kinds of layers (Both of these seem to be under the process of rewriting via Slimming paint v2)<br>&nbsp;&nbsp;&nbsp; PaintLayer - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;paint&#x2F;PaintLayer&#x2e;h&#x3f;q&#x3d;PaintLayer&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;142">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;paint&#x2F;PaintLayer.h?q=PaintLayer&amp;sq=package:chromium&amp;l=142</a> - PaintLayers group layout objects into one place depending on paint order<br>&nbsp;&nbsp;&nbsp; GraphicsLayer - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;GraphicsLayer&#x2e;h&#x3f;q&#x3d;GraphicsLayer&amp;sq&#x3d;package&#x3a;chromium&amp;dr&#x3d;CSs&amp;l&#x3d;27">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;GraphicsLayer.h?q=GraphicsLayer&amp;sq=package:chromium&amp;dr=CSs&amp;l=27</a> - Things that need their own texture &#x2F; surface. Not 1:1 with PaintLayer<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; Multiple PaintLayers can go into 1 graphics layer. GraphicsLayer just means it gets it&#x27;s own backing store.<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><br>Where are these mini SkPictures coming from via the display lists?<br><ul class="bullet"><li>Are these the actual display items - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;blink&#x2F;web&#x5f;display&#x5f;item&#x5f;list&#x5f;impl&#x2e;cc&#x3f;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;111">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;blink&#x2F;web_display_item_list_impl.cc?sq=package:chromium&amp;l=111</a> ? Compositign items are a wrapper around SkPictures?</li><li>All the CC display items are here -<a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;compositing&#x5f;display&#x5f;item&#x2e;h&#x3f;q&#x3d;CompositingDisplay&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;26">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;compositing_display_item.h?q=CompositingDisplay&amp;sq=package:chromium&amp;l=26</a> in this directory, but these are the CC ones</li><li>All the webkit display items are here - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;paint&#x2F;&#x3f;q&#x3d;CompositingDisplayItem&amp;sq&#x3d;package&#x3a;chromium">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;paint&#x2F;?q=CompositingDisplayItem&amp;sq=package:chromium</a></li><li><a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;paint&#x2F;DisplayItem&#x2e;h&#x3f;l&#x3d;7">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;paint&#x2F;DisplayItem.h?l=7</a></li><li><br></li></ul>What are DisplayItemClients - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;paint&#x2F;DisplayItemClient&#x2e;h&#x3f;q&#x3d;DisplayItemClient&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;23">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;paint&#x2F;DisplayItemClient.h?q=DisplayItemClient&amp;sq=package:chromium&amp;l=23</a> - they actually look like display items in our terms as part of the display list dump<br><ul class="indent"><li><br></li></ul>Current theory<br>&nbsp; GraphicsLayers record paints which output SkPictures - GraphicsLayers know what to paint since they are off the Layout tree. GrahpicsLayers paint into WebKit display items<br>&nbsp; These SkPictures get grouped up into SlimmingPaint type DisplayItemLists - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;display&#x5f;item&#x5f;list&#x2e;h&#x3f;sq&#x3d;package&#x3a;chromium&amp;rcl&#x3d;1475680623&amp;l&#x3d;205">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;display_item_list.h?sq=package:chromium&amp;rcl=1475680623&amp;l=205</a><br>&nbsp; The DisplayItemLists then get converted into CC Display Lists - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;blink&#x2F;web&#x5f;display&#x5f;item&#x5f;list&#x5f;impl&#x2e;cc&#x3f;sq&#x3d;package&#x3a;chromium&amp;rcl&#x3d;1475695348&amp;l&#x3d;53">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;blink&#x2F;web_display_item_list_impl.cc?sq=package:chromium&amp;rcl=1475695348&amp;l=53</a> (I&#x27;m fairly certain CC Display Items are just wrappers around SkPictures)<br>&nbsp; CC Display Lists then tile render replay the SkPictures &#x2F; commands to an actual SkCanvas - These are the slimming paint type of display lists<br>&nbsp;&nbsp;<br>&nbsp; What are WebKit display items used for then? - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;paint&#x2F;DisplayItem&#x2e;h&#x3f;l&#x3d;70">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;paint&#x2F;DisplayItem.h?l=70</a><br>&nbsp; Conversion from Webkit display items to slimming paint display items - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;blink&#x2F;web&#x5f;content&#x5f;layer&#x5f;impl&#x2e;cc&#x3f;q&#x3d;web&#x5f;content&#x5f;layer&#x5f;impl&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;83">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;blink&#x2F;web_content_layer_impl.cc?q=web_content_layer_impl&amp;sq=package:chromium&amp;l=83</a> - DrawDisplayItem is the same name<br><ul class="indent"><li><br></li><li>Webkit display list dump for reddit.com - <a href="https&#x3a;&#x2F;&#x2F;drive&#x2e;google&#x2e;com&#x2F;a&#x2F;mozilla&#x2e;com&#x2F;file&#x2F;d&#x2F;0B880pG1iaq2eSFFBLTItY0RmRVE&#x2F;view&#x3f;usp&#x3d;sharing">https:&#x2F;&#x2F;drive.google.com&#x2F;a&#x2F;mozilla.com&#x2F;file&#x2F;d&#x2F;0B880pG1iaq2eSFFBLTItY0RmRVE&#x2F;view?usp=sharing</a> - Basically looks like a frame tree.</li><li>Blink Display Items are wrappers around LayoutObjects grouped by their paint phase - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;paint&#x2F;PaintPhase&#x2e;h&#x3f;sq&#x3d;package&#x3a;chromium&amp;dr&#x3d;C&amp;rcl&#x3d;1475839200">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;paint&#x2F;PaintPhase.h?sq=package:chromium&amp;dr=C&amp;rcl=1475839200</a></li><li><br></li><li>Simpler look at what CC display items are - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;display&#x5f;item&#x5f;proto&#x5f;factory&#x2e;cc&#x3f;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;29">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;display_item_proto_factory.cc?sq=package:chromium&amp;l=29</a></li><li>cc::DrawingDisplayItem - Just a wrapper around an SKPicture</li><li>Also seems to do some basic global analysis of drawing commands for an SkPicture with analysis_canvas - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;skia&#x2F;ext&#x2F;analysis&#x5f;canvas&#x2e;cc&#x3f;sq&#x3d;package&#x3a;chromium&amp;rcl&#x3d;1475752711&amp;l&#x3d;117">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;skia&#x2F;ext&#x2F;analysis_canvas.cc?sq=package:chromium&amp;rcl=1475752711&amp;l=117</a></li><li><br></li><li><br></li><li><br></li></ul>How does multi threaded painting happen?<br>&nbsp;- Multiple raster tasks that go into a work pool, then the threads just rasterize whatever work is in the pool via tiling<br><br><br>Walkthrough<br><ul class="bullet"><li>Basic example of Hello World text</li><li>Starts with a LayoutTextObject - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;layout&#x2F;LayoutText&#x2e;cpp&#x3f;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;161">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;layout&#x2F;LayoutText.cpp?sq=package:chromium&amp;l=161</a> - Essentially a text dom node</li><li>Assigns RenderLayers to backing store layers ( <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;layout&#x2F;compositing&#x2F;CompositingLayerAssigner&#x2e;cpp&#x3f;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;271&#x29;">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;layout&#x2F;compositing&#x2F;CompositingLayerAssigner.cpp?sq=package:chromium&amp;l=271)</a></li><li>CompositedLayerMapping - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;layout&#x2F;compositing&#x2F;CompositedLayerMapping&#x2e;h&#x3f;q&#x3d;CompositedLayerMapping&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;66">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;layout&#x2F;compositing&#x2F;CompositedLayerMapping.h?q=CompositedLayerMapping&amp;sq=package:chromium&amp;l=66</a> - maps PaintLayers -&gt; GraphicsLayers</li><li>Main thread recording tells compositor thread to paint - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;trees&#x2F;proxy&#x5f;main&#x2e;cc&#x3f;q&#x3d;proxy&#x5f;main&#x2e;cc&amp;sq&#x3d;package&#x3a;chromium&amp;dr&amp;l&#x3d;223">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;trees&#x2F;proxy_main.cc?q=proxy_main.cc&amp;sq=package:chromium&amp;dr&amp;l=223</a></li><li>Assign tiles - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;tiles&#x2F;tile&#x5f;manager&#x2e;cc&#x3f;sq&#x3d;package&#x3a;chromium&amp;rcl&#x3d;1475680623&amp;l&#x3d;634">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;tiles&#x2F;tile_manager.cc?sq=package:chromium&amp;rcl=1475680623&amp;l=634</a></li><li>Start running tile rendering - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;tiles&#x2F;tile&#x5f;manager&#x2e;cc&#x3f;q&#x3d;tile&#x5f;manager&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;949">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;tiles&#x2F;tile_manager.cc?q=tile_manager&amp;sq=package:chromium&amp;l=949</a></li><li>Actual rasterization of things happens on the compositor tile worker thread - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;display&#x5f;item&#x5f;list&#x2e;cc&#x3f;q&#x3d;display&#x5f;item&#x5f;list&#x2e;cc&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;142">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;display_item_list.cc?q=display_item_list.cc&amp;sq=package:chromium&amp;l=142</a> - This is called on the main, compositor, and tile worker threads. Only difference is on main&#x2F;compositor thread, it&#x27;s an SkAnalysisCanvas, not a real SkCanvas we paint on.</li><li>&quot;Paint&quot; which is really starting to record from GraphicsLayers to DisplayItems - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;GraphicsLayer&#x2e;cpp&#x3f;q&#x3d;GraphicsLayer&#x2e;cp&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;277">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;GraphicsLayer.cpp?q=GraphicsLayer.cp&amp;sq=package:chromium&amp;l=277</a></li><li>GraphicsContext are what actually do the drawing - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;GraphicsContext&#x2e;cpp&#x3f;q&#x3d;GraphicsContext&#x2e;cpp&amp;sq&#x3d;package&#x3a;chromium&amp;dr&amp;l&#x3d;720">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;platform&#x2F;graphics&#x2F;GraphicsContext.cpp?q=GraphicsContext.cpp&amp;sq=package:chromium&amp;dr&amp;l=720</a></li></ul><br>Cleaner walkthrough:<br><ul class="bullet"><li>LayoutObjects get wrapped around blink display lists &#x2F; items - grouped based on paint phase <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;paint&#x2F;PaintPhase&#x2e;h&#x3f;sq&#x3d;package&#x3a;chromium&amp;dr&#x3d;C&amp;rcl&#x3d;1475839200">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;paint&#x2F;PaintPhase.h?sq=package:chromium&amp;dr=C&amp;rcl=1475839200</a></li><li>Go down the LayoutObjects and layers and record each LayoutObject&nbsp; as it gets translated into skia calls that gets painted</li><li>Take the objects and convert them into an blink::DisplayItem. At this point, they are mostly just wrappers around recorded SkPictures that were there from the layout being painted</li><li>Run the playback through an analysis phase (might be invalidation)</li><li>Once that is done, convert them to cc::DisplayLists, which are basically still wrappers around SkPictures but without references to the DOM tree suitable for consumption on the compositor thread</li><li>Get painted &#x2F; recorded via SkPicture - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;display&#x5f;item&#x5f;list&#x2e;cc&#x3f;q&#x3d;DisplayItemList&#x3a;&#x3a;Ra&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;141">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;display_item_list.cc?q=DisplayItemList::Ra&amp;sq=package:chromium&amp;l=141</a> - Why does each display item have it&#x27;s own SkPicture? When do they get merged? They get merged during the cc::DisplayList::Raster - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;drawing&#x5f;display&#x5f;item&#x2e;cc&#x3f;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;84">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;drawing_display_item.cc?sq=package:chromium&amp;l=84</a></li><ul class="bullet"><li>Text getting painted - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;paint&#x2F;TextPainter&#x2e;cpp&#x3f;q&#x3d;TextPainter&#x2e;cpp&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;65">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;WebKit&#x2F;Source&#x2F;core&#x2F;paint&#x2F;TextPainter.cpp?q=TextPainter.cpp&amp;sq=package:chromium&amp;l=65</a> which calls into a skia recording - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;third&#x5f;party&#x2F;skia&#x2F;include&#x2F;core&#x2F;SkCanvas&#x2e;h&#x3f;q&#x3d;SkCanvas&amp;sq&#x3d;package&#x3a;chromium&amp;dr&#x3d;CSs&amp;l&#x3d;1097">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;third_party&#x2F;skia&#x2F;include&#x2F;core&#x2F;SkCanvas.h?q=SkCanvas&amp;sq=package:chromium&amp;dr=CSs&amp;l=1097</a></li></ul><li>From blink::Display List -&gt; CC::DisplayList which are SkPictures - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;layers&#x2F;picture&#x5f;layer&#x2e;cc&#x3f;q&#x3d;picture&#x5f;layer&#x2e;cc&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;127">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;layers&#x2F;picture_layer.cc?q=picture_layer.cc&amp;sq=package:chromium&amp;l=127</a></li><li>Playback on compositor tile worker of cc::display items - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;raster&#x5f;source&#x2e;cc&#x3f;q&#x3d;raster&#x5f;source&#x2e;cc&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;199">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;playback&#x2F;raster_source.cc?q=raster_source.cc&amp;sq=package:chromium&amp;l=199</a></li><li><br></li><li>tile compositing - <a href="https&#x3a;&#x2F;&#x2F;cs&#x2e;chromium&#x2e;org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;layers&#x2F;picture&#x5f;layer&#x5f;impl&#x2e;cc&#x3f;q&#x3d;picture&#x5f;layer&#x5f;impl&#x2e;cc&amp;sq&#x3d;package&#x3a;chromium&amp;l&#x3d;331">https:&#x2F;&#x2F;cs.chromium.org&#x2F;chromium&#x2F;src&#x2F;cc&#x2F;layers&#x2F;picture_layer_impl.cc?q=picture_layer_impl.cc&amp;sq=package:chromium&amp;l=331</a></li></ul><br>good sources<br><a href="https&#x3a;&#x2F;&#x2F;www&#x2e;youtube&#x2e;com&#x2F;watch&#x3f;v&#x3d;5Xv2A7aqJ9Y">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=5Xv2A7aqJ9Y</a><br><a href="https&#x3a;&#x2F;&#x2F;www&#x2e;youtube&#x2e;com&#x2F;watch&#x3f;v&#x3d;Sc&#x2d;vQDHAFtU">https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v=Sc-vQDHAFtU</a><br>tiling -<a href="https&#x3a;&#x2F;&#x2F;www&#x2e;chromium&#x2e;org&#x2F;developers&#x2F;design&#x2d;documents&#x2F;impl&#x2d;side&#x2d;painting">https:&#x2F;&#x2F;www.chromium.org&#x2F;developers&#x2F;design-documents&#x2F;impl-side-painting</a><br><a href="https&#x3a;&#x2F;&#x2F;www&#x2e;chromium&#x2e;org&#x2F;blink&#x2F;getting&#x2d;started&#x2d;with&#x2d;blink&#x2d;debugging">https:&#x2F;&#x2F;www.chromium.org&#x2F;blink&#x2F;getting-started-with-blink-debugging</a><br><a href="https&#x3a;&#x2F;&#x2F;www&#x2e;chromium&#x2e;org&#x2F;developers&#x2F;design&#x2d;documents&#x2F;impl&#x2d;side&#x2d;painting">https:&#x2F;&#x2F;www.chromium.org&#x2F;developers&#x2F;design-documents&#x2F;impl-side-painting</a><br>
</body>
</html>
